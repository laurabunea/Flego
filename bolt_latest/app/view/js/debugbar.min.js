/**
 * Debugbar.js
 */function setEditable(e){$(".bolt-editable").addClass("active");$(".bolt-editable").bind("click",function(e){e.preventDefault();$(".bolt-editable").unbind("click").removeClass("active");$(".currentedit").removeClass("currentedit").attr("contentEditable",!1);$(this).addClass("currentedit").attr("contentEditable","").focus();$(".bolt-debugpanel").fadeOut();var t=$(this).offset();$("#editbar").show().css("left",t.left-3).css("top",t.top-34);$(this).data("old",$(this).html());console.log("Data: ",$(this).data("id"))})}function saveSelection(){if(window.getSelection){sel=window.getSelection();if(sel.getRangeAt&&sel.rangeCount){var e=[];for(var t=0,n=sel.rangeCount;t<n;++t)e.push(sel.getRangeAt(t));return e}}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null}function restoreSelection(e){if(e)if(window.getSelection){sel=window.getSelection();sel.removeAllRanges();for(var t=0,n=e.length;t<n;++t)sel.addRange(e[t])}else document.selection&&e.select&&e.select()}try{console.assert(1)}catch(e){console={log:function(){},assert:function(){}}}jQuery.cookie=function(e,t,n){if(typeof t=="undefined"){var a=null;if(document.cookie&&document.cookie!=""){var f=document.cookie.split(";");for(var l=0;l<f.length;l++){var c=jQuery.trim(f[l]);if(c.substring(0,e.length+1)==e+"="){a=decodeURIComponent(c.substring(e.length+1));break}}}return a}n=n||{};if(t===null){t="";n=$.extend({},n);n.expires=-1}var r="";if(n.expires&&(typeof n.expires=="number"||n.expires.toUTCString)){var i;if(typeof n.expires=="number"){i=new Date;i.setTime(i.getTime()+n.expires*24*60*60*1e3)}else i=n.expires;r="; expires="+i.toUTCString()}var s=n.path?"; path="+n.path:"",o=n.domain?"; domain="+n.domain:"",u=n.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),r,s,o,u].join("")};jQuery(function(e){e("#bolt-nipple").bind("click",function(){if(e("#bolt-debugbar").is(":visible")){e("#bolt-debugbar").stop(!0,!0).css("right","0").animate({right:"-=800",opacity:.1},600);e("#bolt-debugbar, .bolt-debugpanel").fadeOut();e.cookie("bolt-debugbar-show","")}else{e("#bolt-debugbar").stop(!0,!0).css("right","-800px").show().animate({right:"+=800",opacity:1},600);e.cookie("bolt-debugbar-show",1)}});e("#bolt-debugbar li").not("#pd-edit, #pd-bolt").find("a").bind("click",function(t){t.preventDefault();var n="#"+e(this).data("for");e(".bolt-debugpanel").not(n).fadeOut();e(n).is(":visible")?e(n).fadeOut():e(n).fadeIn();e(this).data("for")=="bolt-editpanel"&&setEditable()});e.cookie("bolt-debugbar-show")==1?e("#bolt-debugbar").show().css("right","0").css("opacity",1).css("display","block"):e("#bolt-debugbar").hide();e("a#btn-save").bind("click",function(t){t.preventDefault();console.log("save");e(".currentedit").attr("contentEditable",!1);data={id:e(".currentedit").data("id"),contenttype:e(".currentedit").data("contenttype"),field:e(".currentedit").data("field"),value:e(".currentedit").html()};console.log(data);e.ajax({url:"/bolt/updatefield",type:"GET",data:data,success:function(t){e(".result").html(t);console.log("Data saved.");e("#editbar").hide()},error:function(){alert("Post failed.")}})});e("a#btn-cancel").bind("click",function(t){t.preventDefault();e("#editbar").hide();e(".currentedit").html(e(".currentedit").data("old")).attr("contentEditable",!1)});e("a#btn-editbackend").bind("click",function(t){t.preventDefault();var n="/bolt/edit/"+e(".currentedit").data("contenttype")+"/"+e(".currentedit").data("id");document.location=n});e("a#btn-bold").bind("click",function(t){t.preventDefault();document.execCommand("bold",!1,null);e(".currentedit").focus()});e("a#btn-italic").bind("click",function(t){t.preventDefault();document.execCommand("italic",!1,null);e(".currentedit").focus()});e("a#btn-link").bind("click",function(t){t.preventDefault();var n=prompt("Link to:","http://");document.execCommand("CreateLink",!1,n);e(".currentedit").focus()})});